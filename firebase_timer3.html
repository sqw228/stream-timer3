
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Realtime Donation Timer</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body {
      margin: 0;
      background-color: black;
      color: white;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    #timer {
      -webkit-text-stroke: 2px black;
      text-shadow: 2px 2px 4px #000;
      font-size: 80px;
      margin-bottom: 30px;
    }
    #controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
    }
    input, button {
      font-size: 20px;
      padding: 5px;
      margin: 5px;
    }
  </style>
</head>
<body>
  <div id="timer">02:00:00</div>
  <div id="controls">
    <input type="number" id="donationInput" placeholder="–ì—Ä–Ω" min="1">
    <div>
      <button onclick="addTime()">–î–æ–±–∞–≤–∏—Ç—å</button>
      <button onclick="subtractTime()">–£–±–∞–≤–∏—Ç—å</button>
      <button onclick="togglePause()">‚èØ –ü–∞—É–∑–∞</button>
      <button onclick="resetTimer()">üîÅ –°–±—Ä–æ—Å</button>
    </div>
  </div>

  <script>
  const firebaseConfig = {
  apiKey: "AIzaSyC1ZQtIjSKRWsQoCysJp5RuH2BjduStsHQ",
  authDomain: "stream-timer-8a402.firebaseapp.com",
  databaseURL: "https://stream-timer-8a402-default-rtdb.firebaseio.com",
  projectId: "stream-timer-8a402",
  storageBucket: "stream-timer-8a402.firebasestorage.app",
  messagingSenderId: "845338837073",
  appId: "1:845338837073:web:8f237ec733648c58393870",
  measurementId: "G-XB6VMNLLPR"
};

    const isMaster = true;

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const timerRef = db.ref("timerSeconds");
    const pauseRef = db.ref("paused");

    let totalSeconds = 7200;
    let paused = false;

    timerRef.on("value", (snapshot) => {
      totalSeconds = snapshot.val();
      updateDisplay();
    });

    pauseRef.on("value", (snapshot) => {
      paused = snapshot.val();
    });

    function updateDisplay() {
      let hrs = Math.floor(totalSeconds / 3600);
      let mins = Math.floor((totalSeconds % 3600) / 60);
      let secs = totalSeconds % 60;
      document.getElementById("timer").innerText =
        String(hrs).padStart(2, '0') + ":" +
        String(mins).padStart(2, '0') + ":" +
        String(secs).padStart(2, '0');
    }

    if (isMaster) {
      setInterval(() => {
        if (totalSeconds > 0 && !paused) {
          totalSeconds--;
          updateDisplay();
          timerRef.set(totalSeconds);
        }
      }, 1000);
    }

    function addTime() {
      const minutes = parseInt(document.getElementById("donationInput").value);
      if (!isNaN(minutes) && minutes > 0) {
        timerRef.set(totalSeconds + (minutes * 60));
        document.getElementById("donationInput").value = "";
      }
    }

    function subtractTime() {
      const minutes = parseInt(document.getElementById("donationInput").value);
      if (!isNaN(minutes) && minutes > 0) {
        let updated = Math.max(0, totalSeconds - (minutes * 60));
        totalSeconds = updated;
        updateDisplay();
        timerRef.set(updated);
        document.getElementById("donationInput").value = "";
      }
    }

    function togglePause() {
      pauseRef.set(!paused);
    }

    function resetTimer() {
      timerRef.set(7200);
      pauseRef.set(false);
    }
  </script>
</body>
</html>
